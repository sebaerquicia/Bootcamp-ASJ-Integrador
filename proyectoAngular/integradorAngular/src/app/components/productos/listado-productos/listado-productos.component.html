<div class="container-fluid  px-4">
  <div class="row">
    <div class="col">
      <h1 class="mt-4">Listado de Productos</h1>
      <ol class="breadcrumb mb-4">
        <li class="breadcrumb-item"><a href="">Inicio</a></li>
        <li class="breadcrumb-item active">Listado de Productos</li>
      </ol>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <h3 class="">Productos en sistema</h3>
      <div class="row">

        <div class="col-3 pt-2">
          <label for="activoeliminado">Filtrar por Activos/Eliminados </label>
        <select
          class="form-select"
          aria-label="activo"
          [(ngModel)]="filtroActivoEliminado"
          name="activoeliminado"
        >
          <option value="Todos">Todos</option>
          <option value="Activos">Activos</option>
          <option value="Eliminados">Eliminados</option>
        </select>
      </div>
      <div class="col-3 pt-2">
        <label for="">Filtrar por Categoria</label>
        <select
        #categoriasFiltro="ngModel"
        class="form-select"
        name="categoria"
        [(ngModel)]="filtroCategorias"
        (change)="filtrarPorCategoria(categoriasFiltro.value)"
        required
      >
      <option [value]="0">Todas</option>
      <option *ngFor="let categoria of categorias" [value]="categoria.id">
        {{ categoria.nombre_categoria }}
      </option>
    </select>
  </div>
</div>
      <div class="row">
        <div *ngIf="productos.length === 0" class="alert alert-warning">
          No hay productos cargados en el sistema. Por favor, agrega productos.
        </div>

        <table *ngIf="productos.length > 0" class="table">
          <thead>
            <tr>
              <th scope="col">Nombre del producto</th>
              <th scope="col">Categoria</th>
              <th scope="col">Proveedor</th>
              <th scope="col">Precio</th>
              <th scope="col">Baja/Modificación</th>
            </tr>
          </thead>

          <tbody
            id="tableBody"
            class="table__body"
            *ngFor="let producto of productos; let i = index"
            [ngStyle]="{
              'background-color': !producto.eliminado ? 'inherit' : '#ccc'
            }"
          >
            <ng-container
              *ngIf="
                filtroActivoEliminado === 'Todos' ||
                (filtroActivoEliminado === 'Activos' &&
                  producto.eliminado === false) ||
                (filtroActivoEliminado === 'Eliminados' &&
                  producto.eliminado === true)
              "
            >
              <tr>
                <td>{{ producto.nombre_producto | titlecase}}</td>
                <th>{{ producto.categoria.nombre_categoria| titlecase }}</th>
                <td>{{ producto.proveedor.razon_social}}</td>
                <td>{{ producto.precio_producto | currency}}</td>
                <td>
                  <button
                    (click)="editarProducto(producto.id)"
                    class="btn btn-outline-secondary "
                  >
                  Editar
                  </button>
                  <!-- Mostrar el botón de eliminar o dar de alta según si la propiedad "eliminado" es true o false -->
                  <button
                    *ngIf="producto.eliminado"
                    class="btn btn-outline-primary "
                    (click)="eliminarProducto(producto.id)"
                  >
                    Dar de alta<i class="bi bi-upload"></i>
                  </button>
                  <button
                    *ngIf="!producto.eliminado"
                    class="btn btn-outline-danger"
                    (click)="eliminarProducto(producto.id)"
                  >
                    Eliminar<i class="bi bi-trash3"></i>
                  </button>
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
